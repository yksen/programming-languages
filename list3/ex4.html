<style>
    td {
        width: 40px;
        height: 40px;
        border: solid grey 1px;
    }
</style>

<button onclick="generateBoard(18)">Generate</button>
<button onclick="solve()">Solve</button>
<button onclick="play()">Play</button>

<table></table>

<script>
    const board = document.querySelector("table");
    const board_size = 9;
    createBoard();

    function createBoard() {
        for (let i = 0; i < board_size; i++) {
            let tr = document.createElement("tr");
            for (let j = 0; j < board_size; j++) {
                let td = document.createElement("td");
                tr.appendChild(td);
            }
            board.appendChild(tr);
        }
    }

    function generateBoard(n) {
        for (let i = 0; i < board_size; i++) {
            for (let j = 0; j < board_size; j++) {
                board.rows[i].cells[j].innerText = "";
            }
        }
        let indices = [...Array(board_size ** 2).keys()];
        for (let i = 0; i < n; i++) {
            let candidate_numbers = [...Array(9).keys()].map(x => x + 1);

            let random_index = indices.splice(Math.floor(Math.random() * indices.length), 1)[0];
            let random_row = Math.floor(random_index / board_size);
            let random_column = random_index % board_size;

            for (let j = 0; j < board_size; j++) {
                let number = board.rows[random_row].cells[j].innerText;
                if (number != "") {
                    candidate_numbers.splice(candidate_numbers.indexOf(parseInt(number)), 1);
                }
            }

            for (let j = 0; j < board_size; j++) {
                let number = board.rows[j].cells[random_column].innerText;
                if (number != "") {
                    candidate_numbers.splice(candidate_numbers.indexOf(parseInt(number)), 1);
                }
            }

            let square_row = Math.floor(random_row / 3);
            let square_column = Math.floor(random_column / 3);
            for (let j = 0; j < 3; j++) {
                for (let k = 0; k < 3; k++) {
                    let number = board.rows[square_row * 3 + j].cells[square_column * 3 + k].innerText;
                    if (number != "") {
                        candidate_numbers.splice(candidate_numbers.indexOf(parseInt(number)), 1);
                    }
                }
            }

            let random_number = candidate_numbers[Math.floor(Math.random() * candidate_numbers.length)];
            if (random_number != undefined) {
                board.rows[random_row].cells[random_column].innerText = random_number;
            } else {
                i--;
            }
        }
    }

    function solve() {

    }

    function play() {

    }
</script>